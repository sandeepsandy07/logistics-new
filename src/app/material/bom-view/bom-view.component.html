<div >
    <div class="row">
    </div>
    <div *ngIf="BillableForm && billing.view_access" class="container">
        <div class="col-md-3" style="margin-left: 53rem;">
            <button class="button" mat-raised-button color="primary" type="submit" (click)="exportBillableDataToExcel()">Export Data to Excel</button>
        </div>
    <div>
        <table class="center mat-elevation-z8" mat-table [dataSource]="dataSource">
            <ng-container matColumnDef="Sl.no.">
                <th class="bg" mat-header-cell *matHeaderCellDef>Sl.no.</th>
                <td mat-cell *matCellDef="let element;let i=index;">{{i+1}}</td>
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>

            <ng-container matColumnDef="Description">
                <th class="bg" mat-header-cell *matHeaderCellDef >Description</th>
                <td mat-cell *matCellDef="let element"><div><b>SAPDANo : </b>{{element?.sap_ref_item_no}}</div><div><b>CustomerPoRefNo : </b>{{element?.customerPoRefNo}}</div><div><b>ItemDescription : </b>{{element?.item_desc}}</div><div><b>ModelNo : </b>{{element?.model}}</div><div><b>Remarks : </b>{{element?.billableRemark}}</div></td>
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>
              
            <ng-container matColumnDef="TotalQty & UOM">
                <th class="bg" mat-header-cell *matHeaderCellDef width="10%">TotalQty & UOM</th>
                <td mat-cell *matCellDef="let element"><div>Total Qty : {{element?.total_qty}}</div> <div>UOM : {{element?.uom}}</div></td>
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>

            <ng-container matColumnDef="Total & BalanceQty">
                <th class="bg" mat-header-cell *matHeaderCellDef width="15%">Total & BalanceQty</th>
                <td mat-cell *matCellDef="let element"><div>Total : {{element?.total}}</div><div>Balance Qty : {{element?.balance_qty}}</div></td>
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>

            <ng-container matColumnDef="UnitPrice">
                <th class="bg" mat-header-cell *matHeaderCellDef width="10%">UnitPrice</th>
                <td mat-cell *matCellDef="let element">{{element?.unit_price}}</td>
                <td mat-footer-cell *matFooterCellDef><b>Total Amount</b></td>
            </ng-container>

            <ng-container matColumnDef="TotalAmount">
                <th class="bg" mat-header-cell *matHeaderCellDef width="10%">TotalAmount</th>
                <td mat-cell *matCellDef="let element">{{element?.total_amt == null ? '0.00' : element?.total_amt | number: '1.2-2'}}</td>
                <td mat-footer-cell *matFooterCellDef> <span>{{billableTotalAmt == null ? '0.00' : billableTotalAmt | number: '1.2-2' }}</span> </td>
            </ng-container>

            <ng-container matColumnDef="SGST & CGST & IGST">
                <th class="bg" mat-header-cell *matHeaderCellDef width="10%">SGST & CGST & IGST</th>
                <td mat-cell *matCellDef="let element"><div>SGST : {{element?.sgst_amt == null ? '--' : element?.sgst_amt}}</div><div>CGST : {{element?.cgst_amt == null ? '--' : element?.cgst_amt}}</div><div>IGST : {{element?.igst_amt == null ? '--' : element?.igst_amt}}</div></td><br>
                <td mat-footer-cell *matFooterCellDef>  </td>
            </ng-container>

            <ng-container matColumnDef="GSTAmt">
                <th class="bg" mat-header-cell *matHeaderCellDef width="10%">GSTAmt</th>
                <td mat-cell *matCellDef="let element"><div>GST: {{element?.gst_amt == null ? '0.00' : element?.gst_amt | number: '1.2-2'}}</div></td><br>
                <td mat-footer-cell *matFooterCellDef><b>Total Price </b>  </td>
            </ng-container>

            <ng-container matColumnDef="TotalPrice">
                <th class="bg" mat-header-cell *matHeaderCellDef width="10%">TotalPrice</th>
                <td mat-cell *matCellDef="let element">{{element?.total_amt_gst == null ? '0.00' : element?.total_amt_gst | number: '1.2-2'}}</td>
                <td mat-footer-cell *matFooterCellDef><span class="footerdiv5">{{billableTotalPrice == null ? '0.00' : billableTotalPrice | number:'1.2-2' }}</span></td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            <tr mat-footer-row *matFooterRowDef="displayedColumns;"></tr>
        </table>
        <!-- <div class="row">
            <div class="footerdiv4"><b>Grand Total  </b><span class="footerdiv2">{{billableTotalAmt == null ? '0.00' : billableTotalAmt | number: '1.2-2' }}</span><span class="footerdiv5">{{billableTotalPrice == null ? '0.00' : billableTotalPrice | number:'1.2-2' }}</span></div>
        </div> -->
    </div>
</div>


<div class="container" *ngIf="NonBillableForm && billing.view_access">
    <div class="col-md-3" style="margin-left: 53rem;">
        <button class="button" mat-raised-button color="primary" type="submit" (click)="exportDataToExcel()">Export Data to Excel</button>
    </div>
        <table class="center mat-elevation-z8" mat-table [dataSource]="dataSource2">
            <ng-container matColumnDef="Sl.no.">
                <th class="bg" mat-header-cell *matHeaderCellDef width="1%">Sl.no.</th>
                <td mat-cell *matCellDef="let element;let i=index;">{{i+1}}</td>
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>

            <ng-container matColumnDef="Description">
                <th class="bg" mat-header-cell *matHeaderCellDef>Description</th>
                <td mat-cell *matCellDef="let element"><div><b>SAPDANo : </b>{{element?.da_no}}</div><div><b>CustomerPoRefNo : </b>{{element?.customerPoRefNo}}</div><div><b>ItemDescription : </b>{{element?.item_desc}}</div><div><b>ModelNo : </b>{{element?.model}}</div><div><b>ReasonForSuppliesNW : </b>{{element?.reasonForSuppliesNW}}</div><div><b>UnderWorNW : </b>{{element?.underWorNW}}</div>
                    <div><b>Remarks : </b>{{element?.billableRemark}}-{{element?.nonbillableRemark}}</div>
                    
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>

            <ng-container matColumnDef="TotalQty & UOM">
                <th class="bg" mat-header-cell *matHeaderCellDef width="10%">TotalQty & UOM</th>
                <td mat-cell *matCellDef="let element"><div>TotalQty : {{element?.total_qty}}</div><div>UOM : {{element?.uom}}</div></td>
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>

            <ng-container matColumnDef="UnitPrice">
                <th class="bg" mat-header-cell *matHeaderCellDef>UnitPrice</th>
                <td mat-cell *matCellDef="let element">{{element?.unit_price}}</td>
                <td mat-footer-cell *matFooterCellDef><b>Total Amount</b></td>
            </ng-container>

            <ng-container matColumnDef="TotalAmount">
                <th class="bg" mat-header-cell *matHeaderCellDef>TotalAmount</th>
                <td mat-cell *matCellDef="let element">{{element?.total_amt == null ? '0.00' : element?.total_amt | number: '1.2-2'}}</td>
                <td mat-footer-cell *matFooterCellDef><span>{{NonBillTotalAmt == null ? '0.00' : NonBillTotalAmt | number: '1.2-2' }}</span></td>
            </ng-container>

            <ng-container matColumnDef="SGST & CGST & IGST">
                <th class="bg" mat-header-cell *matHeaderCellDef>SGST & CGST & IGST</th>
                <td mat-cell *matCellDef="let element"><div>SGST : {{element?.sgst_amt == null ? '--' : element?.sgst_amt}}</div><div>CGST : {{element?.cgst_amt == null ? '--' : element?.cgst_amt}}</div><div>IGST : {{element?.igst_amt == null ? '--' : element?.igst_amt}}</div></td><br>
                <td mat-footer-cell *matFooterCellDef> </td>
            </ng-container>

            <ng-container matColumnDef="GSTAmt">
                <th class="bg" mat-header-cell *matHeaderCellDef width="8%">GSTAmt</th>
                <td mat-cell *matCellDef="let element"><div>GST : {{element?.gst_amt == null ? '0.00' : element?.gst_amt | number: '1.2-2'}}</div></td><br>
                <td mat-footer-cell *matFooterCellDef><b>Total Price</b> </td>
            </ng-container>

            <ng-container matColumnDef="TotalPrice">
                <th class="bg" mat-header-cell *matHeaderCellDef>TotalPrice</th>
                <td mat-cell *matCellDef="let element">{{element?.total_amt_gst == null ? '0.00' : element?.total_amt_gst | number: '1.2-2'}}</td>
                <td mat-footer-cell *matFooterCellDef><span>{{NonBillTotalPrice == null ? '0.00' : NonBillTotalPrice | number:'1.2-2' }}</span></td>
            </ng-container>
            
            <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns2;"></tr>
            <tr mat-footer-row *matFooterRowDef="displayedColumns2;"></tr>
        </table>
        <!-- <div class="row">
            <div class="footerdiv"><b>Grand Total  </b><span class="footerdiv2">{{NonBillTotalAmt == null ? '0.00' : NonBillTotalAmt | number: '1.2-2' }}</span><span class="footerdiv3">{{NonBillTotalPrice == null ? '0.00' : NonBillTotalPrice | number:'1.2-2' }}</span></div>
        </div> -->
</div>
</div>


