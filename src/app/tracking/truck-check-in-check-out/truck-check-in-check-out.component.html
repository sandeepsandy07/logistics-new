<div *ngIf="MainHeader" style="text-align: center;">
    <span>
        <h2 style="font-size: 25px;">Truck List Status</h2>
    </span>
</div>
<div class="container" *ngIf="MainHeader">
  <mat-tab-group mat-stretch-tabs style="width:100%" class="example-stretched-tabs mat-elevation-z4">
   <!--<mat-tab label="Check-In">
                    <div>
                      <mat-form-field style="margin-left:1rem;" appearance="standard">
                        <mat-label>Search</mat-label>
                        <input matInput (keyup)="applyFilter($event)" #input>
                      </mat-form-field>
                        <table class="lessons-table mat-elevation-z8" mat-table matSort [dataSource]="dataSource1">
                
                          <ng-container matColumnDef="Sl.no.">
                            <th class="bg" mat-header-cell *matHeaderCellDef width="1%">Sl.no.</th>
                            <td mat-cell *matCellDef="let element;let i=index;">{{i+1}}</td>
                          </ng-container>
      
                            <ng-container matColumnDef="TruckType">
                              <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width="3%">TruckType</th>
                              <td mat-cell *matCellDef="let element">{{element?.truckName}}</td>
                            </ng-container>
      
                            <ng-container matColumnDef="TruckReqID">
                              <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width ="2%">TruckReqID</th>
                              <td mat-cell *matCellDef="let element">{{element?.truckReqID}}</td>
                            </ng-container>
    
                            <ng-container matColumnDef="ReqDate">
                              <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width ="4%">ReqDate</th>
                              <td mat-cell *matCellDef="let element">{{element?.created_at | date}}</td>
                            </ng-container>
    
                            <ng-container matColumnDef="Remarks">
                              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Remarks</th>
                              <td mat-cell *matCellDef="let element">{{element?.Remarks}}</td>
                            </ng-container>
    
                            <ng-container matColumnDef="Status">
                                <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Status</th>
                                <td mat-cell *matCellDef="let element">{{element?.status}}</td>
                            </ng-container>
    
                            <ng-container matColumnDef="Destination">
                                <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Destination</th>
                                <td mat-cell *matCellDef="let element">{{element?.destinationName}}</td>
                            </ng-container>

                            <ng-container matColumnDef="Transportation">
                              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Transportation</th>
                              <td mat-cell *matCellDef="let element">{{element?.transportationName}}</td>
                          </ng-container>
    
                            <ng-container matColumnDef="RequestedBy">
                                <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">RequestedBy</th>
                                <td mat-cell *matCellDef="let element">{{element?.created_by}}</td>
                            </ng-container>
                          
                          <ng-container matColumnDef="Action">
                          <th class="bg" mat-header-cell *matHeaderCellDef width ="1%">Action</th>>
                          <td mat-cell *matCellDef="let element;let i=index;"> 
                              <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedIn'" (click)="addDriverDetails(element)">CheckOut</button>
                              <button mat-raised-button color="primary" *ngIf="element.status == 'Open'" (click)="openDialog(element)">CheckIn</button>
                              <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedOut'">Completed</button>
                          </td>
                        </ng-container>
                            <tr mat-header-row *matHeaderRowDef="displayedColumns1"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns1;"></tr>
                        </table>
                        <br>
                        <br>
                        <div *ngIf="resultsLength == 0" class="noRecords">No records found</div>
                        <mat-paginator [length]="100"
                        [pageSize]="10"
                        [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select Page of Users" showFirstLastButtons></mat-paginator>
            </div>
    </mat-tab>-->

    <mat-tab label="Check-Out"> 
      <div>
        <mat-form-field style="margin-left:1rem;" appearance="standard">
          <mat-label>Search</mat-label>
          <input matInput (keyup)="applyFilter2($event)" #input>
        </mat-form-field>
        <table class="lessons-table mat-elevation-z8" mat-table [dataSource]="dataSource2">

          <ng-container matColumnDef="Sl.no.">
            <th class="bg" mat-header-cell *matHeaderCellDef width="1%">Sl.no.</th>
            <td mat-cell *matCellDef="let element;let i=index;">{{i+1}}</td>
          </ng-container>

            <ng-container matColumnDef="Truck Type">
              <th class="bg" mat-header-cell *matHeaderCellDef width="3%">Truck Type</th>
              <td mat-cell *matCellDef="let element">{{element?.truckName}}</td>
            </ng-container>

            <ng-container matColumnDef="DA no">
              <th class="bg" mat-header-cell *matHeaderCellDef width="3%">DA no</th>
              <td mat-cell *matCellDef="let element">{{element?.DA_no}}</td>
            </ng-container>

            <ng-container matColumnDef="SO no">
              <th class="bg" mat-header-cell *matHeaderCellDef width="3%">So no.</th>
              <td mat-cell *matCellDef="let element">{{element?.So_no}}</td>
            </ng-container>


            <!-- <ng-container matColumnDef="TruckReqID">
              <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width ="2%">TruckReqID</th>
              <td mat-cell *matCellDef="let element">{{element?.truckReqID}}</td>
            </ng-container> -->

            <!-- <ng-container matColumnDef="ReqDate">
              <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width ="5%">ReqDate</th>
              <td mat-cell *matCellDef="let element">{{element?.created_at | date}}</td>
            </ng-container> -->

            <ng-container matColumnDef="Vehicle No">
              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Vehicle No</th>
              <td mat-cell *matCellDef="let element">{{element?.vehicle_no}}</td>
            </ng-container>

            <ng-container matColumnDef="Driver Name">
              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Driver Name</th>
              <td mat-cell *matCellDef="let element">{{element?.driver_name}}</td>
            </ng-container>

            <ng-container matColumnDef="Status">
                <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Status</th>
                <td mat-cell *matCellDef="let element">{{element?.status}}</td>
            </ng-container>

            <ng-container matColumnDef="Destination">
                <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Destination</th>
                <td mat-cell *matCellDef="let element">{{element?.destination}}</td>
            </ng-container>

            <ng-container matColumnDef="Transportation">
              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Transportation</th>
              <td mat-cell *matCellDef="let element">{{element?.transportationName}}</td>
          </ng-container>

            <ng-container matColumnDef="Requested By">
                <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Requested By</th>
                <td mat-cell *matCellDef="let element">{{element?.created_by}}</td>
            </ng-container>
          
          <ng-container matColumnDef="Action">
          <th class="bg" mat-header-cell *matHeaderCellDef width ="1%">Action</th>
          <td mat-cell *matCellDef="let element;let i=index;"> 
              <button mat-raised-button color="primary" (click)="openCheckOutDialog(element)">CheckOut</button>
          </td>
        </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns2;"></tr>
        </table>
        <br>
        <br>
        <div *ngIf="resultsLength == 0" class="noRecords">No records found</div>
        <mat-paginator #paginatorLegal="matPaginator" [pageSizeOptions]="[10,20,30]" showFirstLastButtons aria-label="Select Page of Users"></mat-paginator>
</div>
    </mat-tab>

    <mat-tab label="CheckedOut">
      <div>
        <mat-form-field style="margin-left:1rem;" appearance="standard">
          <mat-label>Search</mat-label>
          <input matInput (keyup)="applyFilter3($event)" #input>
        </mat-form-field>
        <mat-form-field style="margin-left:15rem;" appearance="standard">
          <mat-label>Start Date</mat-label>
          <input matInput [matDatepicker]="picker" [(ngModel)]="StartDate" (ngModelChange)="StartDatePickerChange()">
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
        <mat-form-field style="margin-left:1rem;" appearance="standard">
          <mat-label>End Date</mat-label>
          <input matInput [matDatepicker]="picker2" [(ngModel)]="EndDate" (ngModelChange)="EndDatePickerChange()">
          <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
          <mat-datepicker #picker2></mat-datepicker>
        </mat-form-field>

          <button style="margin-left:1rem;" mat-raised-button color="primary" type="submit" (click)="FilterDataOnDate()" >Filter</button>
          <button style="margin-left:1rem;" mat-raised-button color="primary" type="submit" (click)="clearDataOnDate()" >Clear</button>
      
        <table class="lessons-table mat-elevation-z8" mat-table matSort [dataSource]="dataSource3">

          <ng-container matColumnDef="Sl.no.">
            <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width="1%">Sl.no.</th>
            <td mat-cell *matCellDef="let element;let i=index;">{{i+1}}</td>
          </ng-container>

          <ng-container matColumnDef="Truck Type">
            <th class="bg" mat-header-cell *matHeaderCellDef width="3%">Truck Type</th>
            <td mat-cell *matCellDef="let element">{{element?.truckName}}</td>
          </ng-container>

          <ng-container matColumnDef="DA no">
            <th class="bg" mat-header-cell *matHeaderCellDef width="3%">DA no</th>
            <td mat-cell *matCellDef="let element">{{element?.DA_no}}</td>
          </ng-container>

          <ng-container matColumnDef="SO no">
            <th class="bg" mat-header-cell *matHeaderCellDef width="3%">So no.</th>
            <td mat-cell *matCellDef="let element">{{element?.So_no}}</td>
          </ng-container>

            

            <ng-container matColumnDef="Vehicle No">
              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Vehicle No</th>
              <td mat-cell *matCellDef="let element">{{element?.vehicle_no}}</td>
            </ng-container>

            <!-- <ng-container matColumnDef="ReqDate">
              <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width ="4%">ReqDate</th>
              <td mat-cell *matCellDef="let element">{{element?.created_at | date}}</td>
            </ng-container> -->

            <ng-container matColumnDef="Driver Name">
              <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width ="4%">Driver Name</th>
              <td mat-cell *matCellDef="let element">{{element?.driver_name}}</td>
            </ng-container>

            <!-- <ng-container matColumnDef="DriverNo">
              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">DriverNo</th>
              <td mat-cell *matCellDef="let element">{{element?.driver_no}}</td>
            </ng-container> -->

            <ng-container matColumnDef="Checked In">
                <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width="6%">Checked In</th>
                <td mat-cell *matCellDef="let element">{{element?.check_in  | date:'d/M/yyyy h:mm a'}}</td>
            </ng-container>

            <ng-container matColumnDef="Checked Out">
                <th class="bg" mat-header-cell *matHeaderCellDef mat-sort-header width="6%">Checked Out</th>
                <td mat-cell *matCellDef="let element">{{element?.check_out | date:'d/M/yyyy h:mm a'}}</td>
            </ng-container>

            <ng-container matColumnDef="CheckedIn Remarks">
                <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">CheckedIn Remarks</th>
                <td mat-cell *matCellDef="let element">{{element?.check_in_remarks}}</td>
            </ng-container>

            <ng-container matColumnDef="CheckedOut Remarks">
              <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">CheckedOut Remarks</th>
              <td mat-cell *matCellDef="let element">{{element?.check_out_remarks}}</td>
          </ng-container>

          <ng-container matColumnDef="Status">
            <th class="bg" mat-header-cell *matHeaderCellDef width ="2%">Status</th>
            <td mat-cell *matCellDef="let element">{{element.status}}</td>
        </ng-container>

        <ng-container matColumnDef="Action">
          <th class="bg" mat-header-cell *matHeaderCellDef width ="1%">Action</th>
          <td mat-cell *matCellDef="let element"> 
            <button mat-icon-button color="primary" (click)="viewData(element?.truckListId)">
                <mat-icon class="mat-18">visibility</mat-icon>
            </button>
          </td>
        </ng-container>
          
          <!-- <ng-container matColumnDef="Action">
          <th mat-header-cell *matHeaderCellDef width ="1%">Action</th>
          <td mat-cell *matCellDef="let element;let i=index;"> 
              <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedIn'" (click)="openCheckOutDialog(element)">CheckOut</button>
              <button mat-raised-button color="primary" *ngIf="element.status == 'Open'" (click)="addDriverDetails(element)">CheckIn</button>
              <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedOut'">Completed</button>
          </td>
        </ng-container> -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns3"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns3;"></tr>
        </table>
        <br>
        <br>
        <div *ngIf="resultsLength == 0" class="noRecords">No records found</div>
        <mat-paginator #paginatorGSTN="matPaginator" [pageSizeOptions]="[2,10,15]" showFirstLastButtons aria-label="Select Page of Users"></mat-paginator>
</div>
    </mat-tab>
  </mat-tab-group>
</div>

<div class="container" *ngIf="ViewForm">
  <mat-card class="example-card">
    <mat-card-title>Details</mat-card-title>
    <mat-card-content>

      <div class="row">
        <div class="col-6">
          <p><b>Vehicle Number: </b> {{viewRecords.vehicle_no}}</p>
        </div>
        <div class="col-6">
          <p><b>Driver Number: </b>{{viewRecords.driver_no}}</p>
        </div>
      </div>

      <div class="row">
        <div class="col-6">
          <p><b>Driver Name: </b>{{viewRecords.driver_name}}</p>
        </div>
        <div class="col-6">
          <p><b>Truck Name: </b>{{viewRecords.truckName}}</p>
        </div>
      </div>

      <div class="row">
        <div class="col-6">
          <p><b>CheckedIn Date & Time: </b>{{viewRecords.check_in | date:'d/M/yyyy h:mm a'}}</p>
        </div>
        <div class="col-6">
          <p><b>CheckIn Remarks: </b>{{viewRecords.check_in_remarks}}</p>
        </div>
      </div>

      <div class="row">
        <div class="col-6">
          <p><b>CheckedOut Date & Time: </b>{{viewRecords.check_out | date:'d/M/yyyy h:mm a'}}</p>
        </div>
        <div class="col-6">
          <p><b>CheckOut Remarks: </b>{{viewRecords.check_out_remarks}}</p>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <p><b>Loading Remarks: </b>{{viewRecords.loading_remarks}}</p>
        </div>
      </div>
      <!-- <p>Vehicle Number: {{viewRecords.vehicle_no}}</p> -->
      <!-- <p>Driver Number: {{viewRecords.driver_no}}</p> -->
      <!-- <p>Driver Name: {{viewRecords.driver_name}}</p> -->
      <!-- <p>Truck Name: {{viewRecords.truckName}}</p> -->
      <!-- <p>CheckedIn Date & Time: {{viewRecords.check_in}}</p> -->
      <!-- <p>CheckIn Remarks: {{viewRecords.check_in_remarks}}</p> -->
    </mat-card-content>
    <mat-card-actions>
        <button mat-raised-button (click)="setViewForm()" color="primary">Back</button>
    </mat-card-actions>
  </mat-card>
</div>












<!-- <div *ngIf="MainForm">
    <div class="container">
      <div class="row mt-5">
        <div class="col-md-9" style="margin-left:4rem">
                <div class="">
                    <table class="lessons-table mat-elevation-z8" mat-table [dataSource]="dataSource1">
            
                      <ng-container matColumnDef="Sl.no.">
                        <th mat-header-cell *matHeaderCellDef width="1%">Sl.no.</th>
                        <td mat-cell *matCellDef="let element;let i=index;">{{i+1}}</td>
                      </ng-container>
  
                        <ng-container matColumnDef="TruckType">
                          <th mat-header-cell *matHeaderCellDef width="3%">TruckType</th>
                          <td mat-cell *matCellDef="let element">{{element?.truckName}}</td>
                        </ng-container>
  
                        <ng-container matColumnDef="TruckReqID">
                          <th mat-header-cell *matHeaderCellDef width ="2%">TruckReqID</th>
                          <td mat-cell *matCellDef="let element">{{element?.truckReqID}}</td>
                        </ng-container>

                        <ng-container matColumnDef="ReqDate">
                          <th mat-header-cell *matHeaderCellDef width ="4%">ReqDate</th>
                          <td mat-cell *matCellDef="let element">{{element?.created_at | date}}</td>
                        </ng-container>

                        <ng-container matColumnDef="Remarks">
                          <th mat-header-cell *matHeaderCellDef width ="2%">Remarks</th>
                          <td mat-cell *matCellDef="let element">{{element?.status}}</td>
                        </ng-container>

                        <ng-container matColumnDef="Status">
                            <th mat-header-cell *matHeaderCellDef width ="2%">Status</th>
                            <td mat-cell *matCellDef="let element">{{element?.status}}</td>
                        </ng-container>

                        <ng-container matColumnDef="Destination">
                            <th mat-header-cell *matHeaderCellDef width ="2%">Destination</th>
                            <td mat-cell *matCellDef="let element">{{element?.status}}</td>
                        </ng-container>

                        <ng-container matColumnDef="RequestedBy">
                            <th mat-header-cell *matHeaderCellDef width ="2%">RequestedBy</th>
                            <td mat-cell *matCellDef="let element">{{element?.created_by}}</td>
                        </ng-container>
                      
                      <ng-container matColumnDef="Action">
                      <th mat-header-cell *matHeaderCellDef width ="1%">Action</th>
                      <td mat-cell *matCellDef="let element;let i=index;">  -->
                          <!-- <button mat-raised-button color="primary" *ngIf="element.status == 'CheckIn'" (click)="addDriverDetails(element?.truckListId)">CheckOut</button> -->
                          <!-- <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedIn'" (click)="addDriverDetails(element)">CheckOut</button>
                          <button mat-raised-button color="primary" *ngIf="element.status == 'Open'" (click)="addDriverDetails(element)">CheckIn</button>
                          <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedOut'">Completed</button>
                      </td>
                    </ng-container>
                        <tr mat-header-row *matHeaderRowDef="displayedColumns1"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns1;"></tr>
                    </table>
                    <br>
                    <br>
                    <div *ngIf="resultsLength == 0" class="noRecords">No records found</div>
                </div>
        </div>
    </div>
  </div>
  </div> -->

<!-- <div *ngIf="detailsAddFormHeader" style="text-align: center;">
    <span>
        <h2 style="font-size: 25px;">Add - Driver Details</h2>
    </span>
</div> -->

<!-- <div class="container" *ngIf="detailsAddForm">
<div class="row">
    <div class="col-md-3">
        <div class="example-container div">
              <mat-form-field appearance="fill">
                <mat-label>Vehicle Number</mat-label>
                <input matInput placeholder="Vehicle Number" [(ngModel)]="vehicleNumber" ngModel required minlength="1">
                <mat-hint style="color:black">KA 09 g 6754</mat-hint>
              </mat-form-field>
        </div>
      </div>

      <div class="col-md-3">
        <div class="example-container div">
              <mat-form-field appearance="fill">
                <mat-label>Driver Name</mat-label>
                <input matInput placeholder="Driver Name" [(ngModel)]="driverName" ngModel required minlength="1">
                <mat-hint style="color:black">Kishan</mat-hint>
              </mat-form-field>
        </div>
      </div>

      <div class="col-md-3">
        <div class="example-container div">
              <mat-form-field appearance="fill">
                <mat-label>Driver Phone Number</mat-label>
                <input matInput placeholder="Driver Phone Number" [(ngModel)]="driverPhoneNumber" ngModel required minlength="1">
                <mat-hint style="color:black">9700008900</mat-hint>
              </mat-form-field>
        </div>
      </div>
</div>

<div class="row">
    <br/><br/>
    <div class="col-md-3">
      <div class="example-container div">
            <mat-form-field appearance="fill">
              <mat-label>Check In Remarks</mat-label>
              <input matInput placeholder="Check In Remarks" [(ngModel)]="checkInRemarks" ngModel required minlength="1">
            </mat-form-field>
      </div>
    </div>
    <div class="col-md-3">
    <button mat-raised-button color="primary" type="submit" (click)="addDetailsData()">Submit</button><button style="margin-left: 3rem;" mat-raised-button (click)="setaddDetailsBackButton()" color="primary">Back</button>
    </div> 
</div>
</div> -->

<!-- <div *ngIf="checkOutHeader" style="text-align: center;">
  <span>
      <h2 style="font-size: 25px;">Check Out Page</h2>
  </span>
</div>

<div class="container" *ngIf="checkOutDataForm">
<div class="row">
  <div class="col-md-3">
    <div class="example-container div">
          <mat-form-field appearance="fill">
            <mat-label>Check Out Remarks</mat-label>
            <input matInput placeholder="Check Out Remarks" [(ngModel)]="checkOutRemarks" ngModel required minlength="1">
          </mat-form-field>
    </div>
  </div>
  <div class="col-md-3">
    <button mat-raised-button color="primary" type="submit" (click)="updateCheckOutData()">Submit</button><button style="margin-left: 3rem;" mat-raised-button (click)="setCheckOutBackButton()" color="primary">Back</button>
    </div> 
</div>
</div> -->

<!-- <ng-container matColumnDef="DriverName">
  <th mat-header-cell *matHeaderCellDef width ="2%">DriverName</th>
  <td mat-cell *matCellDef="let element">{{element?.driver_name}}</td>
</ng-container>

<ng-container matColumnDef="CheckInDate&Time">
  <th mat-header-cell *matHeaderCellDef width ="2%">CheckInDate&Time</th>
  <td mat-cell *matCellDef="let element">{{element?.check_in}}</td>
</ng-container> -->

<!-- <ng-container matColumnDef="CheckedInRemarks">
              <th mat-header-cell *matHeaderCellDef width ="2%">CheckedInRemarks</th>
              <td mat-cell *matCellDef="let element">{{element?.check_in_remarks}}</td>
            </ng-container> -->

            <!-- <ng-container matColumnDef="Action">checkout tab 
              <th class="bg" mat-header-cell *matHeaderCellDef width ="1%">Action</th>
              <td mat-cell *matCellDef="let element;let i=index;"> 
                  <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedIn'" (click)="openCheckOutDialog(element)">CheckOut</button>
                  <button mat-raised-button color="primary" *ngIf="element.status == 'Open'" (click)="addDriverDetails(element)">CheckIn</button>
                  <button mat-raised-button color="primary" *ngIf="element.status == 'CheckedOut'">Completed</button>
              </td>
            </ng-container> -->


